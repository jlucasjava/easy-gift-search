<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® Vercel Deployment Fix Monitor</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .alert {
            background: rgba(220, 53, 69, 0.8);
            border: 2px solid #dc3545;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .status-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .error { border-left: 4px solid #dc3545; }
        .warning { border-left: 4px solid #ffc107; }
        .info { border-left: 4px solid #17a2b8; }
        .test-btn {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 24px;
            border-radius: 10px;
            color: white;
            text-decoration: none;
            margin: 5px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .test-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .log-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .timeline {
            border-left: 3px solid #ffc107;
            padding-left: 20px;
            margin: 20px 0;
        }
        .timeline-item {
            margin-bottom: 15px;
            padding: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® Vercel Deployment Crisis Monitor</h1>
        
        <div class="alert">
            <h2>‚ö†Ô∏è CRITICAL DEPLOYMENT ISSUE DETECTED</h2>
            <p><strong>Problem:</strong> Vercel is deploying old commit 22d0530 instead of latest commit 558b446</p>
            <p><strong>Impact:</strong> Footer implementation not visible on live site</p>
            <p><strong>Status:</strong> <span id="deployStatus">Monitoring...</span></p>
        </div>

        <div class="status-grid">
            <div class="status-card error">
                <h3>‚ùå Vercel Build Error</h3>
                <div class="log-box">
[07:39:58.051] Cloning github.com/jlucasjava/easy-gift (Branch: production, Commit: 22d0530)
[07:40:01.649] Error: No Output Directory named "public" found after the Build completed
                </div>
                <p><strong>Root Cause:</strong> Using ancient commit without public/ directory</p>
            </div>

            <div class="status-card warning">
                <h3>‚ö° Fix Implemented</h3>
                <ul>
                    <li>‚úÖ Enhanced vercel.json configuration</li>
                    <li>‚úÖ Added vercel.yml override</li>
                    <li>‚úÖ Created .vercel/project.json</li>
                    <li>‚úÖ Force pushed latest commit 558b446</li>
                    <li>‚úÖ Public directory verified (559 files)</li>
                </ul>
            </div>

            <div class="status-card info">
                <h3>üìä Commit Timeline</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>558b446</strong> (LATEST) - Deployment fix configs
                    </div>
                    <div class="timeline-item">
                        <strong>462814a</strong> - Footer implementation complete
                    </div>
                    <div class="timeline-item">
                        <strong>ea037bf</strong> - Vercel config updates
                    </div>
                    <div class="timeline-item">
                        <strong>22d0530</strong> (STUCK) - Ancient commit without public/
                    </div>
                </div>
            </div>
        </div>

        <div class="status-card">
            <h3>üîß Diagnostic Actions</h3>
            <p>Testing live site connectivity:</p>
            
            <button onclick="testMainSite()" class="test-btn">üåê Test Main Site</button>
            <button onclick="testFooterPage()" class="test-btn">üëá Test Footer Page</button>
            <button onclick="testVercelStatus()" class="test-btn">‚ö° Check Vercel Status</button>
            <button onclick="refreshStatus()" class="test-btn">üîÑ Refresh Monitor</button>
            
            <div id="testResults" style="margin-top: 20px;"></div>
        </div>

        <div class="status-card">
            <h3>üìã Expected vs Current State</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4>‚ùå Current (Broken)</h4>
                    <div class="log-box">
Commit: 22d0530 (old)
Status: No public/ directory
Error: Build failed
Footer: Missing
                    </div>
                </div>
                <div>
                    <h4>‚úÖ Expected (Fixed)</h4>
                    <div class="log-box">
Commit: 558b446 (latest)
Status: Public/ directory exists
Build: Should succeed
Footer: Fully implemented
                    </div>
                </div>
            </div>
        </div>

        <div class="status-card">
            <h3>üéØ Manual Verification Links</h3>
            <p>If automated tests fail, try these manual links:</p>
            
            <a href="https://easy-gift-search.vercel.app" target="_blank" class="test-btn">
                üîó Main Site (Should show footer)
            </a>
            
            <a href="https://easy-gift-search.vercel.app/footer-verification.html" target="_blank" class="test-btn">
                üß™ Footer Test Page
            </a>
            
            <a href="https://vercel.com/dashboard" target="_blank" class="test-btn">
                üîß Vercel Dashboard
            </a>
        </div>

        <div class="status-card">
            <h3>üìû Next Steps</h3>
            <ol>
                <li><strong>Wait 2-3 minutes</strong> for Vercel to process the force push</li>
                <li><strong>Click test buttons above</strong> to verify deployment</li>
                <li><strong>If still broken:</strong> Vercel may need manual intervention</li>
                <li><strong>Success indicator:</strong> Footer visible on main site</li>
            </ol>
        </div>
    </div>

    <script>
        let testCount = 0;

        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('deployStatus');
            statusEl.textContent = message;
            statusEl.style.color = type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#ffc107';
        }

        function logResult(message, success = true) {
            const resultsEl = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            const icon = success ? '‚úÖ' : '‚ùå';
            resultsEl.innerHTML += `<div style="margin: 5px 0; padding: 5px; background: rgba(0,0,0,0.2); border-radius: 5px;">
                [${timestamp}] ${icon} ${message}
            </div>`;
            resultsEl.scrollTop = resultsEl.scrollHeight;
        }

        async function testMainSite() {
            testCount++;
            logResult(`Test #${testCount}: Testing main site...`, true);
            
            try {
                const response = await fetch('https://easy-gift-search.vercel.app', { 
                    method: 'HEAD',
                    mode: 'no-cors' 
                });
                logResult('Main site is accessible!', true);
                updateStatus('Site accessible - checking for footer...', 'success');
                
                // Test if we can open it
                window.open('https://easy-gift-search.vercel.app', '_blank');
                logResult('Site opened in new tab - check for footer manually', true);
                
            } catch (error) {
                logResult(`Main site test failed: ${error.message}`, false);
                updateStatus('Site still inaccessible', 'error');
            }
        }

        async function testFooterPage() {
            logResult('Testing footer verification page...', true);
            try {
                window.open('https://easy-gift-search.vercel.app/footer-verification.html', '_blank');
                logResult('Footer test page opened - check results manually', true);
            } catch (error) {
                logResult(`Footer page test failed: ${error.message}`, false);
            }
        }

        async function testVercelStatus() {
            logResult('Checking Vercel deployment status...', true);
            // Since we can't directly access Vercel API, we'll test the main endpoints
            const endpoints = [
                'https://easy-gift-search.vercel.app',
                'https://easy-gift-search.vercel.app/footer-verification.html',
                'https://easy-gift-search.vercel.app/vercel-fix-verification.html'
            ];
            
            for (const endpoint of endpoints) {
                try {
                    await fetch(endpoint, { method: 'HEAD', mode: 'no-cors' });
                    logResult(`‚úÖ ${endpoint.split('/').pop() || 'main'} - accessible`, true);
                } catch (error) {
                    logResult(`‚ùå ${endpoint.split('/').pop() || 'main'} - failed`, false);
                }
            }
        }

        function refreshStatus() {
            updateStatus('Refreshing monitor...', 'info');
            logResult('=== Monitor refreshed ===', true);
            testCount = 0;
            
            setTimeout(() => {
                updateStatus('Ready for testing', 'success');
                logResult('Monitor ready - run tests to check deployment status', true);
            }, 1000);
        }

        // Auto-refresh every 30 seconds
        setInterval(() => {
            const now = new Date().toLocaleTimeString();
            logResult(`Auto-refresh at ${now}`, true);
        }, 30000);

        // Initial status
        updateStatus('Monitoring deployment fix...', 'warning');
        logResult('Monitor started - Vercel deployment fix in progress', true);
    </script>
</body>
</html>
